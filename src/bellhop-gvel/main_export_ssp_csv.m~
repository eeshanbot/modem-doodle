%% main_export_ssp_csv.m

% exports 5 ssps as CSVs (depth,ssp)
% EOF ITP 2013 baseval + eof w/ artifact
% EOF ITP 2013 baseval + eof fix
% HYCOM

%% prep workspace
clear; clc;

DEPTH = 0:1:2680;
DEPTH = DEPTH.';

%% EOF ITP 2013 w/ ARTIFACT
OBJ_EOF = eb_read_eeof('../../data/eeof_itp_Mar2013.nc',true);
artifact_weights = [-10 -9.257 -1.023 3.312 -5.067 1.968 1.47].'; % manually written down weights from Toby's notes

SSP = interp1(OBJ_EOF.depth,OBJ_EOF.baseval,DEPTH,'spline');
writetable(table([DEPTH SSP]),'ssp-artifact-baseval.csv');

SSP = interp1(OBJ_EOF.depth,OBJ_EOF.baseval + OBJ_EOF.eofs * artifact_weights,DEPTH,'spline');
writematrix([DEPTH SSP],'ssp-artifact-eeof.csv');

%% EOF ITP 2013 w/o FIXED
OBJ_EOF = eb_read_eeof('../../data/eeof-itp-fix-2013.nc',true);
fixed_weights = [-6.112 15.368 -1.441 2.219 0.138 -0.322 -1.994].'; % manually chosen by Bradli, post ICEX20

SSP = interp1(OBJ_EOF.depth,OBJ_EOF.baseval,DEPTH,'spline');
writematrix([DEPTH SSP],'ssp-fixed-baseval.csv');

SSP = interp1(OBJ_EOF.depth,OBJ_EOF.baseval + OBJ_EOF.eofs * fixed_weights,DEPTH,'spline');
writematrix([DEPTH SSP],'ssp-fixed-eeof.csv');

%% HYCOM
load hycom-ssp-icex20.mat
SSP = interp1(hycomZ(1:end-1),hycomC(1:end-1),DEPTH,'spline');
writematrix([DEPTH SSP],'ssp-hycom.csv');
